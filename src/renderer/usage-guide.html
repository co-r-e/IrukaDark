<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>IrukaDark Usage Guide</title>
    <style>
      :root {
        color-scheme: dark;
        font-family: 'Inter', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }

      body {
        background: radial-gradient(
          circle at top,
          rgba(43, 135, 255, 0.45),
          rgba(13, 17, 23, 0.92)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }

      .window {
        width: min(460px, 100%);
        max-height: 100%;
        background: rgba(15, 23, 42, 0.78);
        border: 1px solid rgba(148, 163, 184, 0.25);
        border-radius: 24px;
        box-shadow: 0 22px 45px rgba(15, 23, 42, 0.45);
        backdrop-filter: blur(18px);
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      header {
        padding: 18px 24px 12px;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.15));
        border-bottom: 1px solid rgba(148, 163, 184, 0.15);
        -webkit-app-region: drag;
      }

      header h1 {
        margin: 4px 0 6px;
        font-size: 20px;
        letter-spacing: 0.02em;
        font-weight: 700;
        color: #e2e8f0;
      }

      header p {
        margin: 0;
        font-size: 13px;
        color: rgba(226, 232, 240, 0.72);
        line-height: 1.4;
        max-width: 320px;
      }

      .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 11px;
        font-weight: 600;
        padding: 5px 10px;
        border-radius: 999px;
        color: rgba(226, 232, 240, 0.86);
        background: rgba(30, 41, 59, 0.6);
        border: 1px solid rgba(148, 163, 184, 0.35);
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }

      .close-btn {
        -webkit-app-region: no-drag;
        appearance: none;
        border: none;
        border-radius: 999px;
        background: rgba(226, 232, 240, 0.16);
        color: rgba(226, 232, 240, 0.85);
        width: 32px;
        height: 32px;
        font-size: 18px;
        cursor: pointer;
        transition:
          background 0.18s ease,
          transform 0.18s ease;
      }

      .close-btn:hover {
        background: rgba(226, 232, 240, 0.28);
        transform: translateY(-1px);
      }

      .close-btn:active {
        transform: translateY(0);
      }

      main {
        padding: 0 24px 16px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: rgba(148, 163, 184, 0.35) transparent;
      }

      main::-webkit-scrollbar {
        width: 6px;
      }

      main::-webkit-scrollbar-thumb {
        background: rgba(148, 163, 184, 0.35);
        border-radius: 999px;
      }

      section {
        padding: 18px 0 16px;
        border-bottom: 1px solid rgba(148, 163, 184, 0.12);
      }

      section:last-of-type {
        border-bottom: none;
      }

      h2 {
        margin: 0 0 10px;
        font-size: 16px;
        font-weight: 700;
        color: #f1f5f9;
        letter-spacing: 0.01em;
      }

      ul {
        margin: 0;
        padding: 0 0 0 18px;
        display: grid;
        gap: 8px;
        color: rgba(226, 232, 240, 0.82);
        font-size: 13px;
        line-height: 1.5;
      }

      li {
        padding: 0;
      }

      .footer-note {
        margin: 20px 0 10px;
        font-size: 12px;
        color: rgba(148, 163, 184, 0.8);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .footer-note::before {
        content: 'Tip';
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(59, 130, 246, 0.18);
        color: rgba(191, 219, 254, 0.9);
      }

      .actions {
        padding: 0 24px 24px;
        display: flex;
        justify-content: flex-end;
      }

      .actions button {
        -webkit-app-region: no-drag;
        appearance: none;
        border: none;
        border-radius: 12px;
        padding: 10px 18px;
        font-size: 13px;
        font-weight: 600;
        color: #0f172a;
        background: linear-gradient(135deg, #38bdf8, #818cf8);
        cursor: pointer;
        box-shadow: 0 10px 20px rgba(59, 130, 246, 0.35);
        transition:
          transform 0.18s ease,
          box-shadow 0.18s ease,
          filter 0.18s ease;
      }

      .actions button:hover {
        transform: translateY(-1px);
        box-shadow: 0 14px 26px rgba(59, 130, 246, 0.4);
        filter: brightness(1.05);
      }

      .actions button:active {
        transform: translateY(0);
      }

      html[data-theme='light'] body {
        background: radial-gradient(
          circle at top,
          rgba(125, 211, 252, 0.55),
          rgba(226, 232, 240, 0.92)
        );
      }

      html[data-theme='light'] .window {
        background: rgba(248, 250, 252, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.3);
        box-shadow: 0 20px 40px rgba(148, 163, 184, 0.35);
      }

      html[data-theme='light'] header {
        background: linear-gradient(135deg, rgba(56, 189, 248, 0.25), rgba(99, 102, 241, 0.18));
        border-bottom-color: rgba(148, 163, 184, 0.25);
      }

      html[data-theme='light'] header h1 {
        color: #0f172a;
      }

      html[data-theme='light'] header p {
        color: rgba(15, 23, 42, 0.72);
      }

      html[data-theme='light'] .badge {
        background: rgba(226, 232, 240, 0.8);
        color: rgba(30, 41, 59, 0.85);
        border-color: rgba(148, 163, 184, 0.4);
      }

      html[data-theme='light'] .close-btn {
        background: rgba(148, 163, 184, 0.18);
        color: rgba(30, 41, 59, 0.7);
      }

      html[data-theme='light'] .close-btn:hover {
        background: rgba(148, 163, 184, 0.28);
      }

      html[data-theme='light'] section {
        border-bottom-color: rgba(148, 163, 184, 0.28);
      }

      html[data-theme='light'] h2 {
        color: #1f2937;
      }

      html[data-theme='light'] ul {
        color: rgba(31, 41, 55, 0.85);
      }

      html[data-theme='light'] .footer-note {
        color: rgba(71, 85, 105, 0.9);
      }

      html[data-theme='light'] .footer-note::before {
        background: rgba(56, 189, 248, 0.35);
        color: rgba(37, 99, 235, 0.9);
      }
    </style>
  </head>
  <body>
    <div class="window">
      <header>
        <div>
          <span class="badge">IrukaDark</span>
          <h1 id="guideTitle">Usage Guide</h1>
          <p id="guideSubtitle">
            Get set up quickly and make IrukaDark part of your daily workflow.
          </p>
        </div>
        <button class="close-btn" id="windowClose" aria-label="Close">×</button>
      </header>
      <main id="guideSections"></main>
      <div class="footer-note" id="guideFooter">
        Tip: Right-click the main window to open this guide again.
      </div>
      <div class="actions">
        <button id="guideDismiss">Close</button>
      </div>
    </div>

    <script>
      (function () {
        const TEXT = {
          en: {
            lang: 'en',
            title: 'Usage Guide',
            subtitle: 'Get set up quickly and make IrukaDark part of your daily workflow.',
            close: 'Close',
            footer: 'Tip: Right-click the main window to open this guide again.',
            sections: [
              {
                id: 'setup',
                heading: 'Initial Setup',
                items: [
                  'Open “AI Settings” to add your Gemini API key and model for the best responses.',
                  'Adjust theme, opacity, and language from “Appearance” so the window matches your workspace.',
                  'Enable “Show Over All Apps/Spaces” when you want IrukaDark to float above everything else.',
                ],
              },
              {
                id: 'shortcuts',
                heading: 'Keyboard Shortcuts',
                items: [
                  'Alt + A / Option + A: Summarise or explain the selected text instantly.',
                  'Alt + Shift + A: Ask for the slower, detailed explanation.',
                  'Alt + 1 and Alt + Shift + 1: Summarise URLs (standard or detailed) from your selection.',
                  'Alt + R: Translate the latest AI reply using the current translate mode.',
                  'Alt + Q: Pronounce the highlighted text (perfect for language study).',
                  'Alt + S / Alt + Shift + S: Capture an area screenshot and have IrukaDark explain it.',
                  'Control + Alt + 1: Draft a social post from a copied URL when available.',
                  'Option + Command + Z (macOS): Generate an empathy-first rewrite.',
                ],
              },
              {
                id: 'slashes',
                heading: 'Slash Commands',
                items: [
                  'Type “/” in the input to see live suggestions and descriptions.',
                  'Try /what do you mean?, /next, or /table to refine the last response.',
                  'Use /translate_<language> or /translate mode to control translation targets and tone.',
                  'Toggle web search with /web on, /web off, or check status via /web status.',
                  'Keep things tidy with /compact or reset the conversation with /clear.',
                ],
              },
              {
                id: 'chat',
                heading: 'Everyday Chatting',
                items: [
                  'Press Enter to send, Shift + Enter for a new line—perfect for multi-line prompts.',
                  'Click the send button again (or press Enter) while generating to cancel the response.',
                  'Drag the edge of the window to resize and keep transcripts readable.',
                  'Use the tone menu (Casual/Formal) to steer how IrukaDark replies.',
                ],
              },
            ],
          },
          ja: {
            lang: 'ja',
            title: '使い方ガイド',
            subtitle: 'IrukaDarkの初期設定から日常使いまでをコンパクトにまとめました。',
            close: '閉じる',
            footer: 'ヒント: メインウィンドウを右クリックすると、いつでもこのガイドを開けます。',
            sections: [
              {
                id: 'setup',
                heading: '初期設定',
                items: [
                  'メニューの「AI設定」からGemini APIキーとモデルを登録し、回答品質を高めましょう。',
                  '「外観」でライト/ダーク、不透明度、言語を調整して作業環境にフィットさせます。',
                  '常に手元に置きたい場合は「全アプリ・全スペースで表示」をオンにして浮遊表示に。',
                ],
              },
              {
                id: 'shortcuts',
                heading: 'ショートカットキー',
                items: [
                  'Alt + A / Option + A: 選択中のテキストをその場で要約・解説します。',
                  'Alt + Shift + A: じっくり読みたいときの詳しい解説モード。',
                  'Alt + 1 / Alt + Shift + 1: 選択中のURLを通常/詳細モードで要約します。',
                  'Alt + R: 直近のAI回答を現在の翻訳モードで別言語に変換します。',
                  'Alt + Q: 選択テキストを読み上げスタイルに整形（語学学習にも便利）。',
                  'Alt + S / Alt + Shift + S: 囲んだ範囲のスクリーンショットを解説付きで取得します。',
                  'Control + Alt + 1: コピーしたURLからSNS向けポスト案を自動作成します。',
                  'Option + Command + Z (macOS): 感情に寄り添う書き直しを生成します。',
                ],
              },
              {
                id: 'slashes',
                heading: 'スラッシュコマンド',
                items: [
                  '入力欄で「/」を押すと、利用可能なコマンド候補が説明付きで表示されます。',
                  '/what do you mean? や /next、/table で直前の回答を深掘り・整理できます。',
                  '/translate_xx や /translate mode で翻訳先やモードを柔軟に切り替え。',
                  '/web on / off / status でウェブ検索の有効化や状態確認もワンフレーズ。',
                  '/compact でメッセージを折りたたみ、/clear で会話をすばやくリセット。',
                ],
              },
              {
                id: 'chat',
                heading: '通常チャット',
                items: [
                  'Enterで送信、Shift + Enterで改行。複数行プロンプトも快適に入力できます。',
                  '生成中にもう一度送信ボタン（またはEnter）を押すと、レスポンスを中断できます。',
                  'ウィンドウの端をドラッグして大きさを調整。履歴を見返しやすく保てます。',
                  '「トーン（カジュアル/フォーマル）」を切り替えて、返答の雰囲気を制御しましょう。',
                ],
              },
            ],
          },
        };

        function normalizeLang(raw) {
          if (!raw) return 'en';
          const lower = String(raw).toLowerCase();
          if (TEXT[lower]) return lower;
          if (lower.startsWith('ja')) return 'ja';
          return 'en';
        }

        function applyTheme(theme) {
          const normalized = theme === 'light' ? 'light' : 'dark';
          document.documentElement.dataset.theme = normalized;
          document.documentElement.style.colorScheme = normalized;
        }

        function render(lang, theme) {
          const normalizedLang = normalizeLang(lang);
          const copy = TEXT[normalizedLang] || TEXT.en;
          document.documentElement.lang = copy.lang;
          applyTheme(theme);

          const titleEl = document.getElementById('guideTitle');
          const subtitleEl = document.getElementById('guideSubtitle');
          const footerEl = document.getElementById('guideFooter');
          const sectionsEl = document.getElementById('guideSections');
          const closeBtn = document.getElementById('guideDismiss');

          if (titleEl) titleEl.textContent = copy.title;
          if (subtitleEl) subtitleEl.textContent = copy.subtitle;
          if (footerEl) footerEl.textContent = copy.footer;
          if (closeBtn) closeBtn.textContent = copy.close;

          if (sectionsEl) {
            sectionsEl.innerHTML = '';
            copy.sections.forEach((section) => {
              const wrapper = document.createElement('section');
              wrapper.setAttribute('data-section', section.id);

              const heading = document.createElement('h2');
              heading.textContent = section.heading;
              wrapper.appendChild(heading);

              const list = document.createElement('ul');
              section.items.forEach((item) => {
                const li = document.createElement('li');
                li.textContent = item;
                list.appendChild(li);
              });
              wrapper.appendChild(list);

              sectionsEl.appendChild(wrapper);
            });
          }
        }

        window.IRUKADARK_USAGE_UPDATE = (lang, theme) => {
          render(lang, theme);
        };

        const params = new URLSearchParams(window.location.search);
        render(params.get('lang') || 'en', params.get('theme') || 'dark');

        const closeButtons = [
          document.getElementById('windowClose'),
          document.getElementById('guideDismiss'),
        ];
        closeButtons.forEach((btn) => {
          if (btn) {
            btn.addEventListener('click', () => {
              window.close();
            });
          }
        });
      })();
    </script>
  </body>
</html>
