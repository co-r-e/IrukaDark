# Changelog

すべての重要な変更はこのファイルに記録します。

## v1.2.1 (2025-11-13)

### Changed

- ウィンドウの不透明度コントロールを改善。メニューから透明度を細かく調整可能に。
- ツールチップの表示ロジックを最適化し、Swift Automation Bridgeのコードを整理。

### Fixed

- クリップボード履歴の最大サイズ調整を修正し、大量のデータでもパフォーマンスを維持。
- Mac配布版の署名アセットを復元し、ビルドプロセスを安定化。

## v1.2.0 (2025-11-11)

### Added

- 動画ファイル（mp4など）をチャットに添付してAIに分析させる機能を追加。メディア選択ダイアログから動画を選択可能に。
- クリップボード履歴ウィンドウに検索ボックスを統合し、過去のコピー内容を素早く検索・フィルタリング可能に。

### Changed

- ショートカットキーを変更: Option+1（URLサマリー）を Option+Q に統一し、キーバインドを整理。
- Swift Automation Bridgeのパフォーマンスを全体的に改善。クリップボード取得の速度向上とメモリ使用量の最適化。
- プロジェクト全体のパフォーマンスを向上させ、レンダラープロセスの応答性を改善。

### Removed

- Windows/WinUIサポートを完全に削除。macOS専用アプリケーションに特化。

## v1.1.1 (2025-11-05)

### Added

- クリップボード履歴ウィンドウを全面刷新。検索、スニペット管理、右クリックメニュー、履歴の永続化に対応し、過去のコピーを素早く呼び出せるようになりました。
- メインチャットのスラッシュコマンドに候補パネルを追加し、`/translate` や `/web` などのコマンドを入力途中で確認・切り替えできるようになりました。

### Changed

- ショートカット経由で開く入力ダイアログとウィンドウ管理を再構成し、テーマや言語設定の同期とフォーカス復帰を改善しました。
- クリップボード連携ショートカットのエラーハンドリングを強化し、無効な選択やURL検証に失敗した際にメインウィンドウへ明示的なフィードバックを表示します。

## v1.0.37 (2025-11-03)

### Fixed

- 配布版でアイコンポップアップが白く塗りつぶされる問題を解消。ポップアップには `setOpacity` を適用せず、チャットウィンドウのみユーザー設定の透明度を反映するよう調整。

## v1.0.36 (2025-11-03)

### Removed

- 未使用だった Usage Guide ウィンドウと静的 HTML を削除し、配布物を軽量化。
- macOS 自動化ブリッジ／パーミッションヘルパーから未使用エクスポートを整理。
- レンダラー側で使用されていなかった画像表示ヘルパーを削除し、重複ロジックを縮小。

## v1.0.21 (2025-10-13)

### Fixed

- 配布版で Option/Alt+`A` 等のショートカットが無反応になる問題を修正。Swift ヘルパーを electron-builder の `afterSign` で確実に署名し、TCC(アクセシビリティ)が一貫して認識するようにしました。
- Swift ヘルパーを Universal2（arm64 + x86_64）に統一。x64 配布で arm64 専用ヘルパーが同梱される問題を解消。
- ショートカットとブリッジ呼び出しの詳細ログを `~/Library/Logs/IrukaDark/automation.log` に出力。

### Changed

- 初回起動でヘルパーの `ensure-accessibility` を非同期実行し、OS の許可ダイアログを早期に提示。

## v1.0.17 (2025-10-03)

- URLサマリー系ショートカット（Option+1 / Option+Shift+1）がアプリ内でURLを取得・整形してからGeminiへ渡すパイプラインに刷新。URL Context API依存を廃止し、言語別テンプレートと長文トリミング時の注意書きを追加。
- SNS下書きショートカット（Control+Option+1）が同じ整形フローを再利用し、UI言語とトーンに応じて自然な投稿を生成するよう改善。
- メインプロセスで同一プロンプトのテキスト／画像リクエストを5分間キャッシュし、GenAIクライアントのTTLを設けて不要なAPI呼び出しとリソース消費を抑制。
- ショートカット起動時にウィンドウを即座に表示し、macOSのコピー待機を調整してOption+A / Option+1系の取りこぼしを改善。
- レンダラー側でi18n対象要素をキャッシュし、失敗時のエラー提案を詳細化してUIのもたつきを軽減。

## v1.0.16 (2025-10-01)

- URL系ショートカット（Option+1 / Option+Shift+1）を全面刷新。対象ページをアプリ側で取得し、script/style 除去＋改行整形したテキストを Gemini へ渡すパイプラインに切り替え、URL Context API 依存を排除。
- SNS下書きショートカット（Control+Option+1）も同じ抽出ロジックを共用し、整形済みコンテンツをプロンプトに埋め込むよう統一。
- メインプロセス／AI ラッパーから URL Context 特有のブリッジ処理を削除し、Web Search オプションのみをサポート。
- README を更新し、新しい URL フローと参照バッジ挙動の変更を反映。

## v1.0.15 (2025-10-01)

- ショートカット: Control+Option+1 で選択中の URL から SNS 向けの下書きを即生成（無効な選択はエラートーストで通知）。
- クリップボード: macOS の選択テキスト取得をアクセシビリティ API 先読みと `⌘+C` ポーリングの併用に整理。ウィンドウの一時非表示→復帰も自動化し、コピー成功率を改善。
- UI: システムメッセージの改行を保持表示。新ショートカットに合わせたトースト通知と多言語ラベルを追加。

## v1.0.8 (2025-09-15)

- ショートカット: クリップボードの鮮度判定（`isClipboardTextStale`）を廃止。非空テキストのみ失敗扱いに変更。
- 背景監視: クリップボード監視ポーリング（`startClipboardWatcher`）を削除して微小にCPU/省電力を改善。
- AI設定: prefs に API キーが保存済みの場合、入力ダイアログでマスキング表示（保存済みが分かるプレースホルダー）を追加。
- リファクタ: 未使用コード・コメントの整理、lint 警告を解消。

互換性: 破壊的変更なし（旧「鮮度」依存の挙動のみ削除）。
