# Changelog

すべての重要な変更はこのファイルに記録します。

## v1.3.7 (2025-12-07)

### Added

- **タイマー＆ストップウォッチ機能**: オーディオ通知付きのタイマーとストップウォッチ機能を追加。
- **スケジュール機能**: タスク管理用の新しいスケジューリング機能。
- **新ショートカット**: Option+X（サウンドトグル）とOption+Wショートカットを追加。

### Changed

- **言語チューニング**: 言語処理とローカライゼーションを改善。
- **オーディオフィードバック**: タイマー機能用のオーディオ通知システムを強化。

## v1.3.6 (2025-12-04)

### Added

- **音声入力機能**: ハンズフリーでメッセージを入力できる音声認識（Speech-to-Text）機能を追加。
- **Voice Onlyショートカット**: カスタマイズ可能なショートカットアクションに `voiceOnly` を追加。

### Changed

- **ショートカットヒント画面の改善**: IrukaDarkブランディングを中央に配置し、グラデーションスタイルのアプリタイトルを追加。レイアウトを改善し視認性を向上。

## v1.3.5 (2025-12-03)

### Added

- **PDF内容抽出機能**: PDFファイルをチャットに添付してAIに分析させる機能を追加。テキストコンテンツを自動抽出。

## v1.3.4 (2025-12-02)

### Performance

- **macOS Automation Bridge**: クリップボード処理とテキスト操作を改善。
- **LRU Cache**: 自動化操作のメモリ管理を改善するLRUキャッシュを追加。
- **Pasteboard Handling**: より信頼性の高いクリップボード操作のためにペーストボードのスナップショットとリストア機能を強化。

### Changed

- `IrukaAutomation` ネイティブモジュールの安定性を向上。
- `macAutomationBridge.js` のエラーハンドリングとパフォーマンスを改善。

## v1.3.3 (2025-11-30)

### Added

- **クリップボード履歴のカラーコードプレビュー**: カラーコードを含むクリップボードアイテムとスニペットにカラースウォッチプレビューを追加。HEX（#RGB、#RRGGBB、#RGBA、#RRGGBBAA）、RGB/RGBA、HSL/HSLAフォーマットに対応。
- **再起動メニューオプション**: アプリを素早く再起動するためのトレイメニューに「再起動」オプションを追加。全対応言語で利用可能。

### Changed

- IrukaAutomationモジュールにカラーコード検出サポートを追加。

## v1.3.2 (2025-11-30)

### Performance

- **クリップボードポップアップウィンドウ (Swift)**: データパスが変更された場合のみスニペットデータのリロードをトリガーし、不要なファイル読み込みを回避。
- **クリップボードポップアップウィンドウ (Swift)**: カーソルが50ピクセル以上移動した場合のみウィンドウ位置を再計算する位置キャッシュを追加。
- **クリップボード履歴サービス**: 重複検出ロジックを簡素化（lastClipboard/lastImageHash比較で既に処理済み）。
- **ポップアップドラッグコントローラー**: requestAnimationFrameスロットリングを実装し、よりスムーズなドラッグ操作とCPUオーバーヘッドを削減。

### Changed

- クリップボードポップアップ操作の全体的な応答性を改善。

## v1.3.1 (2025-11-29)

### Added

- **スライドテンプレート機能**: スライド生成用のテンプレート管理を追加。カスタムプロンプトと参照画像を保存・編集・削除可能に。`/slide template` コマンドで素早くアクセス。
- **スライド枚数設定**: 生成するスライドの枚数（1-4枚）を設定可能に。`/slide count` コマンドまたは設定から変更。
- **カスタムロゴポップアップアイコン**: ロゴポップアップのアイコンを独自画像にカスタマイズ可能に（推奨: 70x70px）。設定 > 外観 から変更・リセット。

### Changed

- スラッシュコマンドのサジェストにテンプレート項目を追加し、選択しやすく改善。
- 17言語のi18n更新とUI改善。
- パフォーマンス最適化。

## v1.2.22 (2025-11-27)

### Added

- スライド画像生成のショートカット設定とi18n対応。
- 画像生成時のローディングアニメーションを追加。

## v1.2.21 (2025-11-27)

### Fixed

- バグ修正と安定性向上。

## v1.2.20 (2025-11-26)

### Changed

- CI: macOS x64ランナーをmacos-15-intelに更新。

## v1.2.19 (2025-11-26)

### Added

- スニペットへの画像添付機能を追加。

### Changed

- Swiftパフォーマンス改善。

## v1.2.18 (2025-11-25)

### Changed

- 初期ウィンドウの更新。
- 全体的な改善。

## v1.2.17 (2025-11-24)

### Changed

- パフォーマンス改善。

## v1.2.16 (2025-11-23)

### Fixed

- アプリ起動時の自動アクセシビリティプロンプトを削除。

## v1.2.15 (2025-11-23)

### Fixed

- アクセシビリティプロンプトの60秒バックオフを削除。
- ensure-accessibilityコマンドで --prompt-accessibility フラグを正しく処理。
- macOS-15互換性のためのCIキャッシュ修正。

## v1.2.14 (2025-11-23)

### Changed

- パフォーマンス改善。

## v1.2.13 (2025-11-22)

### Performance

- 配布版の起動速度と全体的なレスポンスを大幅に改善。
- asar圧縮設定を `maximum` から `normal` に変更し、ファイル読み込み時の解凍オーバーヘッドを削減。
- V8エンジンの最適化: 本番環境では `--expose-gc` フラグを無効化してオーバーヘッドを削減。ヒープサイズを512MBから2048MBに拡大し、GC頻度を低減。
- preferences.js にメモリキャッシュを実装し、設定ファイルへの繰り返しアクセスを排除。起動時に1回だけ読み込み、以降はメモリから即座に返すよう最適化。

## v1.2.12 (2025-11-21)

### Changed

- 本番環境のパフォーマンス向上のため、すべてのconsole.logステートメントを削除。

## v1.2.11 (2025-11-21)

### Fixed

- electron-builderから無効なzip root-level設定を削除。

## v1.2.10 (2025-11-21)

### Fixed

- CIリトライアクション参照の修正。

## v1.2.9 (2025-11-20)

### Changed

- 全般的な更新。

## v1.2.7 (2025-11-20)

### Changed

- ロゴサイズの最適化。

## v1.2.6 (2025-11-20)

### Added

- ターミナルのi18n対応。

### Changed

- ES2024へのアップグレードとPromise.withResolvers()による最適化。
- ターミナルのアップグレード。

## v1.2.5 (2025-11-19)

### Changed

- パフォーマンス改善。
- チャット機能の更新。

## v1.2.4 (2025-11-18)

### Changed

- Electronのアップグレード。
- ポップアップウィンドウのクリーンアップ。

## v1.2.3 (2025-11-17)

### Added

- スニペットのドラッグ＆ドロップ機能。

### Changed

- チャットウィンドウのクリーンアップ。
- 移動機能のクリーンアップ。

## v1.2.2 (2025-11-14)

### Added

- クリップボード履歴に画像タブを追加。

## v1.2.1 (2025-11-13)

### Changed

- ウィンドウの不透明度コントロールを改善。メニューから透明度を細かく調整可能に。
- ツールチップの表示ロジックを最適化し、Swift Automation Bridgeのコードを整理。

### Fixed

- クリップボード履歴の最大サイズ調整を修正し、大量のデータでもパフォーマンスを維持。
- Mac配布版の署名アセットを復元し、ビルドプロセスを安定化。

## v1.2.0 (2025-11-11)

### Added

- 動画ファイル（mp4など）をチャットに添付してAIに分析させる機能を追加。メディア選択ダイアログから動画を選択可能に。
- クリップボード履歴ウィンドウに検索ボックスを統合し、過去のコピー内容を素早く検索・フィルタリング可能に。

### Changed

- ショートカットキーを変更: Option+1（URLサマリー）を Option+Q に統一し、キーバインドを整理。
- Swift Automation Bridgeのパフォーマンスを全体的に改善。クリップボード取得の速度向上とメモリ使用量の最適化。
- プロジェクト全体のパフォーマンスを向上させ、レンダラープロセスの応答性を改善。

### Removed

- Windows/WinUIサポートを完全に削除。macOS専用アプリケーションに特化。

## v1.1.5 (2025-11-08)

### Added

- 動画機能の改善。

## v1.1.4 (2025-11-07)

### Added

- ランチャー機能を追加。

## v1.1.3 (2025-11-06)

### Fixed

- バグ修正。

## v1.1.1 (2025-11-05)

### Added

- クリップボード履歴ウィンドウを全面刷新。検索、スニペット管理、右クリックメニュー、履歴の永続化に対応し、過去のコピーを素早く呼び出せるようになりました。
- メインチャットのスラッシュコマンドに候補パネルを追加し、`/translate` や `/web` などのコマンドを入力途中で確認・切り替えできるようになりました。

### Changed

- ショートカット経由で開く入力ダイアログとウィンドウ管理を再構成し、テーマや言語設定の同期とフォーカス復帰を改善しました。
- クリップボード連携ショートカットのエラーハンドリングを強化し、無効な選択やURL検証に失敗した際にメインウィンドウへ明示的なフィードバックを表示します。

## v1.1.0 (2025-11-05)

### Added

- **クリップボード＆スニペット履歴**: クリップボードとスニペットの完全な履歴管理機能を追加。

## v1.0.37 (2025-11-03)

### Fixed

- 配布版でアイコンポップアップが白く塗りつぶされる問題を解消。ポップアップには `setOpacity` を適用せず、チャットウィンドウのみユーザー設定の透明度を反映するよう調整。

## v1.0.36 (2025-11-03)

### Removed

- 未使用だった Usage Guide ウィンドウと静的 HTML を削除し、配布物を軽量化。
- macOS 自動化ブリッジ／パーミッションヘルパーから未使用エクスポートを整理。
- レンダラー側で使用されていなかった画像表示ヘルパーを削除し、重複ロジックを縮小。

## v1.0.35 (2025-11-02)

### Added

- チャットへの画像直接ペースト機能。
- スラッシュコマンドの更新。

## v1.0.34 (2025-11-02)

### Added

- 画像生成機能を追加。

## v1.0.33 (2025-10-30)

### Changed

- ウィンドウ位置の調整。

## v1.0.32 (2025-10-30)

### Changed

- 高速出力フォーマットを最適化（Markdownレンダリングを置換）。
- SDKの更新。

## v1.0.31 (2025-10-30)

### Changed

- レスポンスの改善。

## v1.0.21 (2025-10-13)

### Fixed

- 配布版で Option/Alt+`A` 等のショートカットが無反応になる問題を修正。Swift ヘルパーを electron-builder の `afterSign` で確実に署名し、TCC(アクセシビリティ)が一貫して認識するようにしました。
- Swift ヘルパーを Universal2（arm64 + x86_64）に統一。x64 配布で arm64 専用ヘルパーが同梱される問題を解消。
- ショートカットとブリッジ呼び出しの詳細ログを `~/Library/Logs/IrukaDark/automation.log` に出力。

### Changed

- 初回起動でヘルパーの `ensure-accessibility` を非同期実行し、OS の許可ダイアログを早期に提示。

## v1.0.17 (2025-10-03)

- URLサマリー系ショートカット（Option+1 / Option+Shift+1）がアプリ内でURLを取得・整形してからGeminiへ渡すパイプラインに刷新。URL Context API依存を廃止し、言語別テンプレートと長文トリミング時の注意書きを追加。
- SNS下書きショートカット（Control+Option+1）が同じ整形フローを再利用し、UI言語とトーンに応じて自然な投稿を生成するよう改善。
- メインプロセスで同一プロンプトのテキスト／画像リクエストを5分間キャッシュし、GenAIクライアントのTTLを設けて不要なAPI呼び出しとリソース消費を抑制。
- ショートカット起動時にウィンドウを即座に表示し、macOSのコピー待機を調整してOption+A / Option+1系の取りこぼしを改善。
- レンダラー側でi18n対象要素をキャッシュし、失敗時のエラー提案を詳細化してUIのもたつきを軽減。

## v1.0.16 (2025-10-01)

- URL系ショートカット（Option+1 / Option+Shift+1）を全面刷新。対象ページをアプリ側で取得し、script/style 除去＋改行整形したテキストを Gemini へ渡すパイプラインに切り替え、URL Context API 依存を排除。
- SNS下書きショートカット（Control+Option+1）も同じ抽出ロジックを共用し、整形済みコンテンツをプロンプトに埋め込むよう統一。
- メインプロセス／AI ラッパーから URL Context 特有のブリッジ処理を削除し、Web Search オプションのみをサポート。
- README を更新し、新しい URL フローと参照バッジ挙動の変更を反映。

## v1.0.15 (2025-10-01)

- ショートカット: Control+Option+1 で選択中の URL から SNS 向けの下書きを即生成（無効な選択はエラートーストで通知）。
- クリップボード: macOS の選択テキスト取得をアクセシビリティ API 先読みと `⌘+C` ポーリングの併用に整理。ウィンドウの一時非表示→復帰も自動化し、コピー成功率を改善。
- UI: システムメッセージの改行を保持表示。新ショートカットに合わせたトースト通知と多言語ラベルを追加。

## v1.0.8 (2025-09-15)

- ショートカット: クリップボードの鮮度判定（`isClipboardTextStale`）を廃止。非空テキストのみ失敗扱いに変更。
- 背景監視: クリップボード監視ポーリング（`startClipboardWatcher`）を削除して微小にCPU/省電力を改善。
- AI設定: prefs に API キーが保存済みの場合、入力ダイアログでマスキング表示（保存済みが分かるプレースホルダー）を追加。
- リファクタ: 未使用コード・コメントの整理、lint 警告を解消。

互換性: 破壊的変更なし（旧「鮮度」依存の挙動のみ削除）。

## v1.0.0 (2025-09-01)

### Added

- 初回安定版リリース。
- 複数AIモデル対応のチャット機能（OpenAI、Anthropic、Google）。
- クイックアクセス用のロゴポップアップウィンドウ。
- スニペット管理システム。
- ダーク/ライトテーマ対応。
- 17言語の多言語対応。
- グローバルキーボードショートカット。
- macOSネイティブ統合。

---

詳細は [GitHub Releases](https://github.com/co-r-e/IrukaDark/releases) を参照してください。
